<launch>
  <arg name="info_topic_name" default="camera_info"/>
  <arg name="publish_topic_name" default="image_raw"/>
  <arg name="path" default="/data-videos"/>
  <arg name="scene_name" default="Large_Apartment_Night_Near_Couchestar"/>
  <arg name="trajectory" default="ampersand"/>
  <arg name="speed" default="1p0"/>
  <arg name="yaw" default="Constant"/>
  <arg name="outfile" default="vio-vins.csv"/>

  <arg name="timestamp_file_name" default="timestamps.txt"/>
  <arg name="video_name" default="lossless.mov"/>
  <arg name="bagfile_path" default="/data-bags"/>

  <rosparam param="/use_sim_time">true</rosparam>
 
  <include file="$(find vins)/launch/vins_rviz.launch"/> 
  <node type="vins_node" pkg="vins" name="vins_estimator" output="screen" args="/root/catkin_ws/src/VINS-Fusion/config/blackbird/blackbird_stereo_config.yaml /data-results/vins.csv"/>
  
  <node pkg="rosbag" type="play" name="player" output="screen" args="--clock -r 0.25 $(arg bagfile_path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/$(arg trajectory)_maxSpeed$(arg speed).bag" required="true"/>
  
  <!-- group ns="camera_d">
  <node name="republish_images_node" pkg="republish_images" type="republish_images_node" output="screen">
    <remap from="/image_raw" to="image_raw"/>
    <remap from="/camera_info" to="camera_info"/>
    <param name="video_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_D_$(arg scene_name)/$(arg video_name)"/>
    <param name="timestamp_file_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_D_$(arg scene_name)/$(arg timestamp_file_name)"/> 
  </node>
  </group -->

  <group ns="camera_l">
  <node name="republish_images_node_l" pkg="republish_images" type="republish_images_node" output="screen">
    <remap from="/image_raw" to="image_raw"/>
    <remap from="/camera_info" to="camera_info"/>
    <param name="video_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_L_$(arg scene_name)/$(arg video_name)"/>
    <param name="desired_rate" type="double" value="60.0"/>
    <param name="timestamp_file_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_L_$(arg scene_name)/$(arg timestamp_file_name)"/> 
  </node>
  </group>

  <group ns="camera_r">
  <node name="republish_images_node_r" pkg="republish_images" type="republish_images_node" output="screen">
    <remap from="/image_raw" to="image_raw"/>
    <remap from="/camera_info" to="camera_info"/>
    <param name="video_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_R_$(arg scene_name)/$(arg video_name)"/>
    <param name="desired_rate" type="double" value="60.0"/>
    <param name="timestamp_file_name" type="string" value="$(arg path)/$(arg trajectory)/yaw$(arg yaw)/maxSpeed$(arg speed)/images/Camera_R_$(arg scene_name)/$(arg timestamp_file_name)"/> 
  </node>
  </group>
  
</launch>
